\chapter{Hamiltonicidad}%
\label{cap:hamilt}

\section{Gr\'afica abanico $F_n$}%
\label{sec:SimpleFan}

 %TODO: definir la grafica abanico como una trayectoria P_{n-1} y K_1 de tal 
%manera que los primeros n-1 elementos pertenezcan a la trayectoria
%TODO: ver donde poner que cadaa v\'ertices de la grafica de fichas cumple 
%que sus elementos estan ordenados de forma creciente
\begin{proposicion}
        \label{prop:iso-SFan}
            Sean $F_k(F_n)$ una gr\'afica de $k$-fichas y $V_i=\{ Y \in
            V(F_k(F_n) \colon\ v_i \in Y) \}$ un subconjunto de v\'ertices, con
            $1 \leq i \leq n-k$. Sea $S_i$ la subgr\'afica de $F_k(F_n)$
            inducida  por $V_i$. Entoncess $S_i$ es isomorfa a
            $F_{k-1}(F_{n-i})$.
        \end{proposicion}
    
        \begin{proof}
            Sea $V(F_{n-i}) = \{v_{i+1}, v_{i+2}, \dots, v_n\}$, donde
            $V(P_{n-i-1}) = \{v_{i+1}, v_{i+2}, \dots, v_{n-1}\}$ y $V(K_1)=
            \{v_n\}$ por definici\'on. Basta demostrar que existe una funcion
            que sea un isomorfismo entre gr\'aficas entre $S_i$ y
            $F_{k-1}(F_{n-1})$. Proponemos a la funci\'on $A \xrightarrow[]{} A
            \setminus \{v_i\}$ y nos fijamos que cumple ser un isomorfismo de
            gr\'aficas, pues para $A \in V(S_i)$ tenemos que $A \setminus
            \{v_i\} \in \ F_{k-1}(F_{n-i})$  y para $B \in F_{k-1}(F_{n-i})$
            tenemos que $B \cup \{v_i\} \in S_i$. Por lo tanto $S_i \cong
            F_{k-1}(F_{n-i})$, con $1 \leq i \leq n-k$.
        \end{proof}
    
        \begin{teorema}
        \label{teo:hamilt-SFan}
            Sean $n,k \in \mathbb{Z}$ tales que $n \geq 3$ y $1 \leq k \leq n-1$,
            entonces $F_k(F_n)$ es hamiltoniana.
        \end{teorema}
    
        
        \begin{proof}
            Usando doble inducci\'on sobre $k$ y $n$, demostraremos que
            $F_k(F_n)$ tiene un ciclo hamiltoniano donde los v\'ertices
            $\{v_{n-k}, v_{n-k+1}, \dots, v_{n-2}, v_n\}$ y $\{v_{n-k},
            v_{n-k+1}, \dots, v_{n-2}, v_{n-1}\}$ son adyacentes. Para esta
            demostraci\'on consideraremos que para todo v\'ertice $A = \{a_1,
            \dots, a_k\}$ de una gr\'afica de $k$-fichas se tiene $a_1 < \cdots
            < a_k$. Observamos que para $k =1$ tenemos que $F_1(F_n) \cong F_n$
            por lo que es hamiltoniana y, por definici\'on de gr\'afica abanico,
            se cumple que $\{v_{n-k}, v_{n-k+1}, \dots, v_{n-2}, v_n\}$ y
            $\{v_{n-k}, v_{n-k+1}, \dots, v_{n-2}, v_{n-1}\}$ son adyacentes.
            Entonces, asumiremos $k \geq 2$ para el resto de la demostraci\'on.
            Primero consideramos el caso en el que $k =2$. Si tomamos $n = 3$,
            tenemos la gr\'afica con conjunto de v\'ertices $V(F_n)=\{v_1, v_2,
            v_3\}$. Entonces tenemos el siguiente ciclo hamiltoniano $C=
            (\{v_1,v_3\},\{v_1,v_2\},\{v_2,v_3\}, \{v_1,v_3\})$, donde $\{v_1,
            v_3\}$ y $\{v_1, v_2\}$ son adyacentes. 
            
            Ahora veamos el caso de la gr\'afica de $2$-fichas de $F_n$, con $n
            \geq 4$ y conjunto de v\'ertices $V(F_n)=\{v_1,\dots, v_n\}$.
            Tomamos el ciclo
    
            $C = (\{v_1, v_{n-1}\},\{v_1, v_n\},\{v_1, v_{n-2}\}, \{v_1,
            v_{n-3}\}, \dots, \{v_1, v_2\},$
            
            $\{v_2, v_n\}, \{v_2, v_{n-1}\}, \{v_2, v_{n-2}\},
            \dots, \{v_2, v_3\},$
    
            $ \dots,$
    
            $\{v_{n-3},v_n\}, \{v_{n-3}, v_{n-1}\},\{v_{n-3},v_{n-2}\},
            \{v_{n-2}, v_n\},\{v_{n-2}, v_{n-1}\}, \{v_{n-1}, v_n\}, \{v_1,
            v_{n-1}\})$
    
            Observamos que $C$ es un ciclo hamiltoniano que cumple tener la
            adyacencia de  $\{v_{n-2}, v_n\}$ y $\{v_{n-2}, v_{n-1}\}$. 
    
            Ahora supongamos que $F_{k'}(F_{n'})$ satisface las hipotesis de
            inducci\'on, con $k'< k$ y $n'<n'$. 
            %\'o $F_k(F_{n'})$ satisface las hipotesis de inducci\'on, con 
            %$n'<n$ y $k < n'$. 
            Sea $F_{k-1}(F_{n-i})$, con $1 \leq i \leq n-k$. Por
            \cref{prop:iso-SFan}, tenemos que $F_{k-1}(F_{n-i}) \cong S_i$,
            donde $S_i= F_k(F_n, V_i)$. Adem\'as, por hip\'otesis de
            inducci\'on, $F_{k-1}(F_{n-i})$ tiene un ciclo hamiltoniano, $C_i$,
            con los v\'ertices $X_i = \{v_i, v_{n-k+1}, v_{n-k+2}, \dots,
            v_{n-2}, v_n\}$ y $Y_i= \{v_i, v_{n-k+1}, v_{n-k+2}, \dots, v_{n-2},
            v_{n-1}\}$ adyacentes en $C_i$ . Nombramos $P_i$ a la subtrayectoria
            hamiltoniana de $X_i$ a $Y_i$ y denotamos $Z$ al v\'ertice
            $\{v_{n-k+1}, v_{n-k+2}, \dots, v_n\}$. Observamos que para $i=
            n-k+1$ tenemos que $V_i = \{Z\}$, donde $V_i$ es el conjunto
            mencionado en \cref{prop:iso-SFan}. Esto \'ultimo, pues los
            elementos estan colocados de forma creciente, de manera que $Z$ es
            el \'unico v\'ertice que cumple tener elemento m\'inimo $v_{n-k+1}$. 
    
            Ahora, sea $D_j =\{v_{n-k}, v_{n-k+1}, \dots, v_{n-1}, v_n\}
            \setminus \{v_j\}$, con $n-k+1 \leq j \leq n$.  De esta manera,
            podemos ver al conjunto de v\'ertices de $S_{n-k}$ como
            $V_{n-k}=\{D_n, D_{n-1}, \dots, D_{n-k+1}\}$. Observamos que
            $D_{j-1} \triangle D_j= \{v_{j-1}, v_j\}$, para $n-k+2 \leq j \leq
            n-2$. Entonces tenemos la trayectoria $Q= (D_n, D_{n-1}, \dots,
            D_{n-k+1})$ en $S_{n-k}$.     
            Luego, fij\'emonos en que, para $j= n-k$, tenemos que $Y_j = D_n$ y
            $X_j= D_{n-1}$. Adem\'as tenemos las siguientes diferencias
            sim\'etricas $X_{n-k}\triangle D_{n-2} =\{v_{n-2}, v_n\}$,
            $Y_{n-k}\triangle D_{n-2} =\{v_{n-2}, v_{n-1}\}$ , $Z\triangle
            D_{n-k+1} =\{v_{n-k}, v_{n-k+1}\}$. Por lo tanto, en $F_k(F_n)$,
            tenemos las siguientes adyacencias: $X_{n-k} \sim D_{n-2}$, $Y_{n-k}
            \sim D_{n-2}$ y $Z \sim D_{n-k+1}$. Adicionalmente, observamos que,
            para $1 \leq i \leq n- k- 1$, tenemos $X_{i} \triangle X_{i+1}=
            \{v_i, v_{i+1}\}$ y $Y_i \triangle Y_{i+1} = \{v_i, v_{i+1}\}$.
            Tambi\'en tenemos que $Y_1 \triangle Z = \{v_1, v_n\}$. Por lo tanto
            tenemos que $Y_1 \sim Z$, $X_i \sim X_{i+1}$ y $Y_i \sim Y_{i+1}$,
            para toda $1 \leq i \leq n-k-1$.
            
            Por lo tanto podemos definir el siguiente ciclo hamiltoniano $C$ en
            $F_k(F_n)$: 
    
            En el caso en el que $n-k$ sea par:
            
            $C =(X_1 \xrightarrow[P_1]{} Y_1, Y_2 \xrightarrow[P_2]{} X_2,
            \dots, X_{n-k-1} \xrightarrow[P_{n-k-1}]{} Y_{n-k-1}, Y_{n-k},
            X_{n-k}, D_{n-2} \xrightarrow[Q]{} D_{n-k+1}, Z, X_1)$
    
            En el caso en el que $N-k$ sea impar:
    
            $C = (X_1 \xrightarrow[P_1]{} Y_1, Y_2 \xrightarrow[P_2]{} X_2,
            \dots, Y_{n-k-1} \xrightarrow[P_{n-k-1}]{} X_{n-k-1}, X_{n-k},
            Y_{n-k}, D_{n-2} \xrightarrow[Q]{} D_{n-k+1}, Z, X_1)$
    
            En ambos casos $C$ es un ciclo hamiltoniano que, adem\'as, cumple
            que los v\'ertices $X_{n-k}$ y $Y_{n-k}$ son adyacentes. 
    
        \end{proof}

\section{Gr\'afica abanico generalizada $F_{m,n}$}%
\label{sec:GeneralFan}



\begin{teorema}
\label{teo:2-TokGenerFan}
    La gr\'afica de 2-fichas de $F_{m,n}$ es hamiltoniana si y s\'olo si $n \geq
    2$ y $1 \leq m \leq 2n$, o si $n=1$ y $m=3$.
\end{teorema}



% TODO:definicion de grafica abanico generalizada
% TODO: dem de prop sobre relacion entre componentes conexas y hamiltonicidad
%TODO: caso en el que n=1
\begin{proof}
    Primero veamos que para $n \geq 2$ y $1 \leq m \leq 2n$ la gr\'afica de
    $2$-fichas de $F_{m,n}$ es hamiltoniana. Para esto construiremos un ciclo
    hamiltorniano espec\'ifico para cada caso. Consideramos $m=1$ para el primer
    caso. Si $n=2$, entonces $F_2(F_{m,n}) \cong F_{1,2}$ pues ambas son
    isomorfas a $K_3$. Ahora consideramos $n \geq 3$ y tomamos $1 \leq i \leq n$
    para construir una familia de trayectorias
    $T_i=(\{v_i,w_1\},\{v_i,v_{i+1}\},\{v_i,v_{i+2}\},\dots, \{v_i,v_n\})$. Observamos
    que $\{V(T_1),V(T_2),\dots, V(T_n)\}$ es una partici\'on de
    $V(F_2(F_{m,n}))$. %especificar mas?
    Ahora analizamos el siguiente ciclo $C$.
    
    En el caso en el que $n$ es par, tomamos:

    $C=(\{v_1,v_n\} \xrightarrow[T_1]{}\{v_1,w_1\},\{v_2,w_1\}
    \xrightarrow[T_2]{}\{v_2,v_n\},\{v_3,v_n\} \xrightarrow[T_3]{}\{v_3,w_1\},
    \dots, \{v_{n-1},v_n\}
    \xrightarrow[T_{n-1}]{}\{v_{n-1},w_1\},\{v_n,w_1\},\{v_1,v_n\})$

    En el caso en el que $n$ es impar, tomamos:

    $C=(\{v_1,v_n\} \xrightarrow[T_1]{}\{v_1,w_1\},\{v_2,w_1\}
    \xrightarrow[T_2]{}\{v_2,v_n\},\{v_3,v_n\} \xrightarrow[T_3]{}\{v_3,w_1\},
    \dots, \{v_{n-1},w_1\}
    \xrightarrow[T_{n-1}]{}\{v_{n-1},v_n\},\{v_n,w_1\},\{v_1,v_n\})$

    Primero comprobemos que $C$ es un ciclo en $F_2(F_{m,n})$. En $F_{m,n}$
    tenemos que $v_i \sim v_{i+1}$. Adem\'as $|\{v_i,w_1\}\triangle
    \{v_{i+1},w_1\}|=2 =|\{v_i,v_n\}\triangle \{v_{i+1},v_n\}|$, por lo que
    $\{v_i,w_1\}\sim \{v_{i+1},w_1\}$ y $\{v_i,v_n\}\sim \{v_{i+1},v_n\}$ en
    $F_2(F_{m,n})$. Por lo tanto tenemos que $C$ es un ciclo en ambos casos.
    Adicionalmente tenemos que los los v\'ertices de las trayectorias son una
    partici\'on de los v\'ertices de $F_2(F_{m,n})$, por lo que $C$ es un ciclo
    hamiltoniano.

    Para el segundo caso consideramos $m=2n$. Definimos la siguiente familia de
    trayectorias. A $P_1$ la definimos como la subtrayectoria hamiltoniana de
    $\{v_n,w_1\}$ a $\{v_n,w_1\}$, es decir $P_1= (\{v_n,w_1\}
    \xrightarrow[C]{}\{v_1,v_n\})$. 
    
    Para $1 < i \leq n$ definimos
    $P_i=(\{w_i,v_n\},\{w_i,w_1\},\{w_i,v_{n-1}\},\{w_i,w_{i+(n-1)}\},\{w_i,v_{n-2}\},$
    $\{w_i,w_{i+(n-2)}\},\dots,\{w_i,v_2\},\{w_i,w_{i+2}\},\{w_i,v_1\},\{w_i,w_{i+1}\})$

    Para $n+1\leq i \leq 2n$, consideramos los \'indices de los v\'ertices de
    $\overline{K_m}$ $\mod 2n$, con $2n \mod 2n \equiv 2n$, para definir
    $P_i=(\{w_i,v_n\},\{w_i,w_{n+1}\},\{w_i,v_{n-1}\},\{w_i,w_{i+(n-1)}\},\{w_i,v_{n-2}\},$
    $\{w_i,w_{i+(n-2)}\},\dots,
    \{w_i,v_2\},\{w_i,w_{i+2}\},\{w_i,v_1\},\{w_i,w_{i+1}\})$

    Afirmamos que $P_i$ es una trayectoria en $F_2(F_{m,n})$. $P_1$ cumple ser
    una trayectoria de la gr\'afica de $2$-fichas pues viene de recorrer el
    ciclo $C$. Observamos que para toda $P_i$, con $2\leq i \leq 2n$, los
    elementos tienen configuraci\'on $\{w_i,v_j\},\{w_i,w_k\}$, con $i, k\in
    \{1, \dots, 2n\}$ y $j \in \{1, \dots, n\}$. M\'as a\'un, a partir del
    tercer elemento de $P_i$, tenemos a los elementos con la forma
    $\{w_i,v_j\},\{w_i,w_{i+j}\}$, con $j \in \{1, \dots, n-1\}$.  Por otro lado
    sabemos que, para toda $i \in \{1, \dots, n\}$ y $j \in \{1, \dots, m\}$, se
    cumple que $v_i \sim w_j$ en $F_{m,n}$ y adem\'as $|\{w_i,v_j\} \triangle
    \{w_i, w_{i+j}\}|=2$, por lo que $\{w_i,v_j\} \sim \{w_i, w_{i+j}\}$ en
    $F_2(F_{m.n})$. Entonces $P_i$ s\'i cumple ser una trayectoria en la
    gr\'afica de $2$-fichas. Ahora construimos el ciclo deseado usando las
    trayectorias $P_i$. Notamos que para, $2 \leq i \leq 2n$, el primer elemento
    de $P_i$ es $\{w_i, v_n\}$ y el \'ultimo elemento es $\{w_i, w_{i+1}\}$, que
    son adyacentes por el atgumento anterior. Entonces tenemos que el \'ultimo
    elemento de $P_i$ y el primer elemento de $P_{i+1}$ son adyacentes.
    Adem\'as, usando el mismo argumento, tenemos que el \'ultimo elemento de
    $P_1$, es decir $\{v_1,v_n\}$, que es adyacente al primer elemento de $P_2$,
    que es $\{w_2,v_n\}$. De manera an\'aloga $\{w_{2n},w_1\}$, el \'ultimo
    elemento de $P_{2n}$, es adyacente a $\{v_n,w_1\}$, el primer elemento de
    $P_1$. Por lo tanto $C_1 = (P_1,P_2, \dots, P_{2n},\{v_n,w_1\})$ es un ciclo
    en $F_2(F_{m,n})$. 
    
    Ahora determinamos si $C_1$ es un ciclo hamiltoniano de la gr\'afica de
    $2$-fichas. Al igual que en el caso anterior, veamos que las trayectorias de
    $P_i$ generan una partici\'on de $F_2(F_{m,n})$. Primero tenemos que los
    v\'ertices de la forma $\{v_i,v_j\}$ est\'an en $P_1$, con $i,j \in \{1,
    \dots, n\}$ y $i \neq j$. Tambi\'en tenemos que los v\'ertices $\{w_i,w_1\}$
    est\'an en $P_1$, con $i \in \{1, \dots, m\}$ y $1 \neq i$. Luego nos
    fijamos en los v\'ertices $\{w_i,v_j\}$ que est\'an en $P_i$, para $i\in
    \{1, \dots, m\}$ y $j \in \{1, \dots, n\}$. Por \'ultimo, veamos los
    v\'ertices del tipo $\{w_i,w_j\}$, tomando $i < j$. Si $1 < i \leq n$ y $i <
    j \leq i+n-1$, entonces tenemos que $\{w_i,w_j\} \in P_i$, mientras que, si
    tomamos $1 < i \leq n$ y $i+n-1 < j \leq 2n$, tenemos que $\{w_i,w_j\} \in
    P_j$. Ahora, si tomamos $n<i<j \leq 2n$, tenemos que $\{w_i,w_j\} \in P_i$.
    Por lo tanto $\{V(P_1),V(P_2), \dots, V(P_{2n})\}$ es una partici\'on de
    $V(F_2(F_{m,n}))$. Por lo tanto $C_1$ es un ciclo hamiltoniano.

    Por \'ultimo, veamos el caso en el que $1<m<2n$ y del mismo modo que en los
    casos anteriores, definiremos una familia de trayectorias en $F_2(F_{m,n})$.
    Primero definimos $Q_1 =P_1$. Ahora nos fijamos en $1<i<m$ para definir
    $Q_i$. Queremos usar $P_i$ como referencia para generar las nuevas
    trayectorias, pero $P_i$ tiene m\'as v\'ertices de la forma $\{w_i,w_j\}$,
    en particular cuando $j< n+i-m$. Entonces defnimos $Q_i =
    (\{w_i,v_n\},\{w_i,w_1\},\{w_i,v_{n-1}\},\{w_i,v_{n-2}\}, \dots,
    ,\{w_i,v_{n-j}\},\{w_i,w_{n-j-1}\}\xrightarrow[P_i]{}\{w_i,w_{i+1}\})$, con
    $j = n+i-m-1$. Finalmente, definimos $Q_m$ como la trayectoria
    $(\{w_m,v_n\},\{w_m,w_1\},\{w_m,v_{n-1}\},\{w_m,v_{n-2}\}, \dots,
    ,\{w_m,v_{n-j}\},\{w_m,w_{n-j-1}\}\xrightarrow[P_m]{}\{w_m,w_{m+1}\})$ al
    intercambiar los v\'ertices $\{w_m,w_{m+1}\}$ y $\{w_m,w_1\}$. Observamos
    que las trayectorias $Q_i$ son trayectorias en $F_2(F_{m,n})$ pues $v_i \sim
    v_{i+1}$ en $F_{m,n}$. Adem\'as, esta familia de trayectorias forma una
    partici\'on para $F_2(F_{m,n})$ pues son las trayectorias $P_i$ al quitarle
    los v\'ertices $\{w_i,w_j\}$, con $j< n+i-m$. Por \'ultimo, notamos que,
    salvo $Q_m$, las trayectorias $P_i$ y $Q_i$ tienen los mismos v\'ertices
    iniciales y finales, adicionalmente, el \'ultimo v\'ertice de $Q_i$, es
    decir $\{w_m,w_1\}$, es adyacente al primer v\'ertice de $P_1$, que es
    $\{v_n,w_1\}$. Por lo tanto el ciclo $C_2=(Q_1,Q_2, \dots, Q_m,
    \{v_n,w_1\})$ es el ciclo hamiltoniano buscado.

    Ahora veamos que para cuando $m>2n$. Sea $S \subset V(F_2(F_{m,n}))$, con
    $S=\{\{w_i,v_j\} \colon\ i \in \{1,\dots,m\},j\in\{1,\dots,n\}\}$. Primero,
    observamos que todo v\'ertice $\{w_i,w_j\}$ tiene a todos sus vecinos en $S$
    por lo que es un v\'ertice aislado en $F_2(F_{m,n})-S$, donde $i,j \in
    \{1,\dots,m\}$ tal que $i \neq j$. Entonces tenemos $\binom{m}{2}$
    v\'ertices aislados en $F_2(F_{m,n})-S$. Adem\'as, la subgr\'afica inducida
    por los v\'ertices de tipo $\{v_i,v_j\}$ forman una componente conexa en
    $F_2(F_{m,n})-S$. Por lo tanto enemos que $F_2(F_{m,n})-S$ tiene al menos
    $\binom{m}{2} + 1$ componentes conexas. Despejando tenemos que $\binom{m}{2}
    + 1 = \frac{m(m-1)}{2} + 1 \geq \frac{m(2n)}{2} + 1 = mn + 1 > mn = |S|$.
    Por lo tanto, por la (Proposicion que falta) tenemos que $F_2(F_{m,n})$ no
    es hamiltoniana.

\end{proof}